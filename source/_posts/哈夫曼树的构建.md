---
title: å“ˆå¤«æ›¼æ ‘çš„æ„å»º
date: 2022-05-18 22:41:18
tags: 
    - åä¸‡ä¸ªä¸ºä»€ä¹ˆ
    - ç®—æ³•
cover: ./../images/å“ˆå¤«æ›¼æ ‘çš„æ„å»º-Xnip2022-05-18_17-42-40.png
---
- [å“ˆå¤«æ›¼æ ‘æ˜¯å¦‚ä½•æ„å»ºçš„ï¼Ÿ](#å“ˆå¤«æ›¼æ ‘æ˜¯å¦‚ä½•æ„å»ºçš„)
    - [å­—ç¬¦åœ¨è®¡ç®—æœºä¸­çš„å­˜åœ¨å½¢å¼](#å­—ç¬¦åœ¨è®¡ç®—æœºä¸­çš„å­˜åœ¨å½¢å¼)
    - [å“ˆå¤«æ›¼ç¼–ç æ˜¯ç”¨æ¥å¹²ä»€ä¹ˆçš„ï¼Ÿ](#å“ˆå¤«æ›¼ç¼–ç æ˜¯ç”¨æ¥å¹²ä»€ä¹ˆçš„)
    - [å“ˆå¤«æ›¼ç¼–ç æ˜¯å¦‚ä½•å®ç°å‹ç¼©çš„å‘¢ï¼Ÿ](#å“ˆå¤«æ›¼ç¼–ç æ˜¯å¦‚ä½•å®ç°å‹ç¼©çš„å‘¢)
    - [æ„å»ºå“ˆå¤«æ›¼æ ‘](#æ„å»ºå“ˆå¤«æ›¼æ ‘)
    - [è®¡ç®—å“ˆå¤«æ›¼ç¼–ç ï¼ˆ~~Todo, å¤œå·²æ·±, å…ˆç¡è§‰äº†, é†’åæ›´æ–°~~ï¼Œ2022/05/18 doneï¼‰](#è®¡ç®—å“ˆå¤«æ›¼ç¼–ç todo-å¤œå·²æ·±-å…ˆç¡è§‰äº†-é†’åæ›´æ–°20220518-done)
    - [ç®€å•ç¤ºä¾‹](#ç®€å•ç¤ºä¾‹)
    - [é¿å…æµªè´¹](#é¿å…æµªè´¹)
    - [è¿è¡Œç»“æœ](#è¿è¡Œç»“æœ)
    - [ç¢ç¢è¯](#ç¢ç¢è¯)

# å“ˆå¤«æ›¼æ ‘æ˜¯å¦‚ä½•æ„å»ºçš„ï¼Ÿ

ä»Šå¤©åœ¨ã€Šç¨‹åºæ˜¯æ€æ ·è·‘èµ·æ¥çš„ã€‹ä¸€ä¹¦ä¸­æåŠäº†å“ˆå¤«æ›¼ç¼–ç çš„æ„å»ºè¿‡ç¨‹ã€‚çªç„¶å›å¿†èµ·ç¬¬ä¸€æ¬¡æ¥è§¦å“ˆå¤«æ›¼ç¼–ç è¿˜æ˜¯ä¸¤å¹´å‰çš„å¤§ä¸€ï¼Œé‚£æ—¶è¿äºŒå‰æ ‘éƒ½ä¸æ‡‚ï¼Œæ›´åˆ«æä»€ä¹ˆå“ˆå¤«æ›¼ç¼–ç äº†ã€‚ä½†æ˜¯å¦‚ä»Šçœ‹äº†ä¹¦ä¸­çš„æ„å»ºæ€è·¯ï¼Œæˆ‘å·²ç»æœ‰äº†å¤§è‡´çš„ä»£ç å®ç°æ€è·¯ï¼Œç«‹åˆ»è¶ç€æ€ç»ªæ³‰æ¶Œï¼Œèµ¶ç´§æ‰“å¼€vscodeï¼ŒæŠŠè„‘å­é‡Œçš„æ„è±¡ä¸€æ­¥æ­¥çš„æ•²ä¸‹æ¥ã€‚å®Œæˆä¹‹åï¼Œè¿è¡Œè°ƒè¯•ï¼Œç¬¦åˆé¢„æœŸï¼Œå¤§å–œï¼Œæ¬£æ¬£ç„¶~

è¶ç€å…´å¥‹çš„çŠ¶æ€è¿˜æœªæ¶ˆå»ï¼Œèµ¶ç´§å†™ä¸‹æ­¤ç¯‡æ–‡ç« ï¼Œä»¥åŠ æ·±è®°å¿†ã€‚

### å­—ç¬¦åœ¨è®¡ç®—æœºä¸­çš„å­˜åœ¨å½¢å¼

æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œä¸€ä¸ªåŠè§’å­—ç¬¦å ç”¨ä¸€ä¸ªå­—èŠ‚(byte)ï¼Œä¹Ÿå°±æ˜¯8æ¯”ç‰¹(bit)ã€‚ä¸€ä¸ªå…¨è§’å­—ç¬¦å ç”¨2ä¸ªå­—èŠ‚ã€‚ï¼ˆä¸€ä¸ªæ±‰å­—ä¸ºä¸€ä¸ªå…¨è§’ï¼‰

> ![album_temp_1652800133](./../images/å“ˆå¤«æ›¼æ ‘çš„æ„å»º-album_temp_1652800133.jpeg)
>
> *ã€Šç¨‹åºæ˜¯æ€æ ·è·‘èµ·æ¥çš„ã€‹å›¾6-1*

é‚£ä¹ˆæ•°æ®å‹ç¼©æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿå…¶å®å°±æ˜¯å‡å°‘é‡å¤æ•°æ®ã€‚å‹ç¼©æ•ˆç‡è¶Šé«˜ï¼Œæ„å‘³ç€å¯¹é‡å¤æ•°æ®çš„åˆ©ç”¨ç‡ä¹Ÿè¶Šé«˜ã€‚

é‚£ä¹ˆï¼Œ

### å“ˆå¤«æ›¼ç¼–ç æ˜¯ç”¨æ¥å¹²ä»€ä¹ˆçš„ï¼Ÿ

å®ƒä¹Ÿæ˜¯ä¸€ç§å‹ç¼©ç®—æ³•ã€‚

### å“ˆå¤«æ›¼ç¼–ç æ˜¯å¦‚ä½•å®ç°å‹ç¼©çš„å‘¢ï¼Ÿ

æ•°æ®ä¸­å‡ºç°æ•°æ®é‡å¤åº¦æœ€é«˜å­—ç¬¦ï¼ˆå³å‡ºç°é¢‘ç‡é«˜ï¼‰çš„æˆ‘ä»¬é€‰ç”¨ä¸€ç§é•¿åº¦å°½å¯èƒ½çŸ­çš„ç¼–ç æ›¿æ¢ï¼Œå­—ç¬¦é‡å¤åº¦ä½ï¼ˆå³å‡ºç°é¢‘ç‡ä½ï¼‰åˆ™é€‰ç”¨é•¿åº¦è¾ƒé•¿çš„ç¼–ç æ›¿æ¢ã€‚ç”±äºå‡ºç°é¢‘ç‡é«˜çš„å­—ç¬¦éƒ½ä½¿ç”¨äº†çŸ­ç¼–ç ï¼Œé¢‘ç‡ä½çš„å­—ç¬¦é€‰ç”¨è¾ƒé•¿çš„ç¼–ç ã€‚é‚£ä¹ˆæ˜¾è€Œæ˜“è§ï¼Œå¦‚æ­¤å¤„ç†åçš„æ•°æ®å æ®ç©ºé—´ä¼šæ¯”åŸæ•°æ®çš„ç©ºé—´è¦å°ï¼Œä¹Ÿå°±å®ç°äº†æ•°æ®å‹ç¼©ã€‚

### æ„å»ºå“ˆå¤«æ›¼æ ‘

> ![album_temp_1652804549](./../images/å“ˆå¤«æ›¼æ ‘çš„æ„å»º-album_temp_1652804549.png)
>
> *ã€Šç¨‹åºæ˜¯æ€æ ·è·‘èµ·æ¥çš„ã€‹å›¾6-5 å“ˆå¤«æ›¼æ ‘çš„ç¼–ç é¡ºåº*

å¤§è‡´æ­¥éª¤ä¹¦ä¸­å·²ç»™å‡ºï¼Œä½†å›¾ä¸­æœ€ç»ˆæ„å»ºçš„å“ˆå¤«æ›¼æ ‘ä¸æˆ‘è‡ªå·±çš„ç¨‹åºæ„å»ºçš„ç•¥æœ‰ä¸åŒï¼Œè‹¥è¦å®ç°å›¾ä¸­çš„æ ‘ç»“æ„ï¼Œä¼¼ä¹è¿˜éœ€è¦è¿›è¡Œä¸€äº›çŠ¶æ€å‹ç¼©å¤„ç†ï¼Œä½†æˆ‘çš„ç®—æ³•å±äºå…¶ç®€åŒ–ç‰ˆï¼Œå¹¶æ²¡æœ‰çŠ¶æ€å‹ç¼©éƒ¨åˆ†çš„å†…å®¹ï¼Œä½†å¯¹äºç†è§£å“ˆå¤«æ›¼ç¼–ç çš„ç›®çš„åº”è¯¥è¾¾åˆ°äº†ã€‚

æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ç¼–ç ã€‚

æ—¢ç„¶éœ€è¦å¾—çŸ¥å­—ç¬¦ä¸²çš„å‡ºç°é¢‘ç‡ï¼ˆæ¯”è¾ƒå‡ºç°æ¬¡æ•°å³å¯ï¼‰ï¼Œé‚£ä¹ˆè‡ªç„¶éœ€è¦ç»Ÿå‡ºé™¤å„ä¸ªå­—ç¬¦åœ¨å­—ç¬¦ä¸²ä¸­å‡ºç°çš„æ¬¡æ•°ã€‚

ä»¥å­—ç¬¦ä¸²`string s = "AAAAAABBCDDEEEEEF";`ä¸ºä¾‹ã€‚

æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå“ˆå¸Œè¡¨`map<char, int> table;`æ¥è®°å½•å„ä¸ªå­—ç¬¦åœ¨`s`å‡ºç°çš„æ¬¡æ•°ã€‚

é€šè¿‡éå†`s`ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°`table`æ•°æ®å¦‚ä¸‹ï¼š

| å­—ç¬¦ | A   | B   | C   | D   | E   | F   |
| ---- | --- | --- | --- | --- | --- | --- |
| é¢‘æ•° | 6   | 2   | 1   | 2   | 5   | 1   |

ä¹¦ä¸­æåˆ°äº†éœ€è¦å°†`table`æŒ‰é¢‘æ•°è¿›è¡Œæ’åºã€‚

ç”±äºä¹¦ä¸­æ­¥éª¤äºŒæ¯ä¸€æ¬¡éƒ½éœ€è¦é€‰å‡ºä¸¤ä¸ªé¢‘ç‡æœ€å°çš„æ•°ï¼Œåœ¨ä¸¤æ•°åˆå¹¶æˆä¸€ä¸ªæ•°åæœ‰éœ€è¦å›åˆ°å…¶é˜Ÿåˆ—ã€‚

é‚£ä¹ˆæˆ‘ä»¬ä¸å¦¨ä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—æ¥æ¨¡æ‹Ÿè¿™æ ·çš„æ“ä½œã€‚æ ¹æ®ä¼˜å…ˆé˜Ÿåˆ—çš„æ€§è´¨ï¼Œæ¯ä¸€æ¬¡å°†å…ƒç´ å…¥é˜Ÿï¼Œä¼˜å…ˆé˜Ÿåˆ—éƒ½ä¼šæŒ‰ç…§å…¶å…ƒç´ æƒé‡æ”¾å…¥å…¶åº”è¯¥æ”¾å…¥çš„ä½ç½®ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œæˆ‘ä»¬é¿å…äº†æ¯æ¬¡éƒ½éœ€è¦ç”¨æ‰‹åŠ¨æ’åºæ¥ä¿è¯å…ƒç´ é¡ºåºï¼Œåªéœ€è¦å¤„ç†å…¥é˜Ÿå‡ºé˜Ÿå³å¯ã€‚

æˆ‘ä»¬çº¦å®šäº†ä¸€ä¸ª`TreeNode`å¯¹è±¡æ¥æè¿°å“ˆå¤«æ›¼æ ‘ç»“ç‚¹ï¼š

```C++
class TreeNode {
public:
    int weight; // å­—ç¬¦æƒé‡
    char data; // å­—ç¬¦
    TreeNode* left;
    TreeNode* right;
    TreeNode(int weight, char data) {
        this->weight = weight;
        this->data = data;
        this->left = nullptr;
        this->right = nullptr;
    }

    TreeNode(int weight, char data, TreeNode* left, TreeNode* right) {
        this->weight = weight;
        this->data = data;
        this->left = left;
        this->right = right;
    }

    ~TreeNode() {
        cout << "TreeNode -> weight: " <<  this->weight << " has been released." << endl;
    }

};
```

ä»¥ä¸‹å°±æ˜¯æ„å»ºå“ˆå¤«æ›¼æ ‘çš„æ ¸å¿ƒä»£ç `build`ã€‚

```C++
// ä¼˜å…ˆé˜Ÿåˆ—è‡ªå®šä¹‰æ’åºï¼Œæƒé‡é«˜çš„å‘åæ’ï¼ˆä¼˜å…ˆé˜Ÿåˆ—é»˜è®¤æƒé‡è¶Šé«˜è¶Šå‰ï¼Œä¸ºäº†å…¶æƒé‡è¶Šä½è¶Šåœ¨å‰ï¼Œæ‰€ä»¥è¿™é‡Œåäº†è¿‡æ¥ä½¿ç”¨äº†>ï¼‰
struct cmp {
    bool operator()(TreeNode* a, TreeNode* b) {
        return a->weight > b->weight;
    }
};
TreeNode* build(string& s) {
    // æ„é€ ä¸€é¢—å“ˆå¤«æ›¼æ•°
    // é¦–å…ˆéœ€è¦ç»Ÿè®¡å­—ç¬¦ä¸²å‡ºç°çš„æ¬¡æ•°
    map<char, int> _map;
    for (char& c : s) _map[c]++;
    // ä½¿ç”¨ä¸€ä¸ªä¼˜å…ˆé˜Ÿåˆ—æ¥ç»´æŠ¤æƒå€¼çš„ä½ç½®å…³ç³»ï¼Œ
    priority_queue<TreeNode*, vector<TreeNode*>, cmp> que;
    // å°†æ¯ä¸ªå…ƒç´ æ„å»ºæˆTreeNodeï¼Œè¿›è¡Œå…¥é˜Ÿ
    for (auto& pack : _map) {
        int data = pack.first;
        char val = pack.second;
        que.push(new TreeNode(val, data));
    }
    // è‡ªåº•å‘ä¸Šæ„é€ å“ˆå¤«æ›¼æ ‘ï¼Œæ¯æ¬¡åˆå¹¶éƒ½ä¼šå‡å°‘é˜Ÿåˆ—ä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼ˆ2ä¸ªå…ƒç´ åˆå¹¶æˆ1ä¸ªå…ƒç´ ï¼‰ï¼Œå½“ä¼˜å…ˆé˜Ÿåˆ—ä»…å‰©ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œæ­¤æ—¶è¿™ä¸ªå…ƒç´ å°±æ˜¯å“ˆå¤«æ›¼æ ‘çš„æ ¹èŠ‚ç‚¹
    while (que.size() > 1) {
        TreeNode* node1 = que.top();
        que.pop();
        TreeNode* node2 = que.top();
        que.pop();
        int weight = node1->weight + node2->weight;
        // æ¯ä¸€æ¬¡åˆå¹¶ï¼Œéƒ½æ„å»ºä¸€ä¸ªæ–°çš„TreeNodeï¼Œå¹¶å°†ç”¨äºåˆå¹¶çš„ä¸¤ä¸ªç»“ç‚¹ä½œä¸ºå…¶å·¦å³å­æ ‘ï¼Œåˆå¹¶åçš„TreeNodeä½¿ç”¨ '\0' åŒºåˆ†
        que.push(new TreeNode(weight, '\0', node1, node2));
    }
    // è¿”å›å“ˆå¤«æ›¼æ ¹èŠ‚ç‚¹
    return que.top();
}

```



è¿™æ ·ï¼Œä¸€é¢—å“ˆå¤«æ›¼æ ‘å°±æ„å»ºå®Œæˆäº†ï¼Œå¯æ˜¯å•å•æ„å»ºè¿˜ä¸å¤Ÿï¼Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨è¿™é¢—å“ˆå¤«æ›¼æ ‘å¾—å‡ºå“ˆå¤«æ›¼ç¼–ç ã€‚

æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œå“ˆå¤«æ›¼æ ‘åªéœ€è¦ç»Ÿä¸€åœ¨å·¦å³å­æ ‘çš„æ ‘æä¸Šæ ‡è®°0ã€1ï¼Œç„¶åä»æ ¹èŠ‚ç‚¹ä¸€è·¯å‘ä¸‹è¿›è¡Œæ ‡è®°ï¼Œè·¯å¾„ä¸€ç›´è®°å½•åˆ°å¶å­ç»“ç‚¹ï¼Œé‚£ä¹ˆè¿™ä¸ªè·¯å¾„å³ä¸ºå½“å‰å­—ç¬¦çš„å“ˆå¤«æ›¼ç¼–ç ã€‚

å¦‚å›¾ï¼ˆç»¿è‰²ä»£è¡¨åˆæˆç»“ç‚¹ï¼Œè“è‰²ä»£è¡¨åŸç”Ÿçš„å­—ç¬¦ç»“ç‚¹ï¼Œè“è‰²åº•éƒ¨æ–‡å­—ä»£è¡¨å…¶å¯¹åº”çš„å“ˆå¤«æ›¼ç¼–ç ï¼Œå¾ˆæ˜¾ç„¶ï¼Œå­—ç¬¦ç»“ç‚¹å‡ä¸ºå¶å­ç»“ç‚¹ï¼‰ï¼š

![Xnip2022-05-18_00-00-56](./../images/å“ˆå¤«æ›¼æ ‘çš„æ„å»º-Xnip2022-05-18_17-42-40.png)

æ‰€ä»¥ï¼Œæˆ‘ä»¬è¦å¦‚ä½•æ‰èƒ½è®¡ç®—å‡ºå“ˆå¤«æ›¼ç¼–ç å‘¢ï¼Ÿ

### è®¡ç®—å“ˆå¤«æ›¼ç¼–ç ï¼ˆ~~Todo, å¤œå·²æ·±, å…ˆç¡è§‰äº†, é†’åæ›´æ–°~~ï¼Œ2022/05/18 doneï¼‰

æˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œå“ˆå¤«æ›¼ç¼–ç æ˜¯ç”±å…¶0ã€1æ˜ å°„æˆçš„è·¯å¾„æ„æˆã€‚æˆ‘ä»¬è¦è·å¾—å…¶å­—ç¬¦çš„å“ˆå¤«æ›¼ç¼–ç ï¼Œå°±éœ€è¦é€šè¿‡éå†è¿™ä¸ªå“ˆå¤«æ›¼æ ‘å®ç°ã€‚

æ—¢ç„¶æ˜¯éå†äºŒå‰æ ‘ï¼Œé‚£å¾ˆè‡ªç„¶çš„æƒ³åˆ°äºŒå‰æ ‘æœ‰ä¸‰ç§ç»å…¸çš„éå†æ–¹å¼ï¼Œåˆ†åˆ«æ ‘å‰ã€ä¸­ã€ååºéå†ã€‚ä½†å…¶å®è¿™é‡Œæ— æ‰€è°“å“ªç§æ–¹å¼ï¼Œéƒ½æ˜¯å¯è¡Œçš„ã€‚

è¿™é‡Œæˆ‘ç”¨çš„æ˜¯å‰åºéå†çš„æ–¹å¼ï¼Œä½¿ç”¨é€’å½’è°ƒç”¨å®ç°ã€‚

æˆ‘ä»¬å‡å®šè¯¥å‡½æ•°åä¸º`dfs`ã€‚

æˆ‘ä»¬éœ€è¦ç»™é€’å½’å‡½æ•°æä¾›å“ªäº›å‚æ•°ï¼Ÿ

- `TreeNode* node`ï¼Œæ¯«æ— ç–‘é—®ï¼Œéå†äºŒå‰æ ‘è‡ªç„¶éœ€è¦æä¾›ç»“ç‚¹å‚æ•°ï¼Œå³`node`ã€‚

- `string path`ï¼Œæˆ‘ä»¬éœ€è¦å¾—åˆ°å¶å­ç»“ç‚¹çš„å“ˆå¤«æ›¼ç¼–ç ï¼Œä¹Ÿå°±æ˜¯éœ€è¦è®°å½•æ ¹èŠ‚ç‚¹åˆ°å…¶å¶å­ç»“ç‚¹çš„è®¿é—®è·¯å¾„ã€‚é‚£ä¹ˆéœ€è¦ä¸€ä¸ªé¢å¤–å‚æ•°`path`æ¥è®°å½•è®¿é—®è·¯å¾„ã€‚
- `map<char, string>& huffman_code_table`ï¼Œæˆ‘ä»¬éœ€è¦æœ‰ä¸€ä¸ªå“ˆå¸Œè¡¨`huffman_code_table`æ¥è®°å½•å­—ç¬¦å¯¹åº”çš„ç¼–ç ã€‚

é‚£ä¹ˆå‡½æ•°ç­¾ååº”ä¸º`void dfs(TreeNode* node, string pathï¼Œmap<char, string>& huffman_code_table)`ã€‚

é‚£ä¹ˆå¦‚ä½•é€’å½’å‘¢ï¼Ÿ

ç¬¬ä¸€æ­¥ï¼Œéœ€è¦ç»™é€’å½’å‡½æ•°ä¸€ä¸ª`base case`ï¼Œå³ç»ˆæ­¢é€’å½’çš„æ¡ä»¶ã€‚å½“`node`ä¸º`nullptr`æ—¶è‡ªç„¶å°±ä¸éœ€è¦ç»§ç»­é€’å½’äº†ã€‚

```C++
void dfs(TreeNode* node, string pathï¼Œmap<char, string>& huffman_code_table) {
  if (!node) return;
  /** pass */
}
```

ç¬¬äºŒæ­¥ï¼Œè‹¥å½“å‰ç»“ç‚¹æ˜¯å¶å­ç»“ç‚¹æ—¶ï¼Œä¹Ÿå°±æ„å‘³ç€å½“å‰çš„`node`å°±æ˜¯å­—ç¬¦æ‰€åœ¨çš„ç»“ç‚¹ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±è¦åœ¨ç¼–ç è¡¨`huffman_code_table`ä¸­ï¼Œå°†`path`ä¸å­—ç¬¦`node->data`å»ºç«‹èµ·æ˜ å°„å…³ç³»äº†ã€‚

```C++
void dfs(TreeNode* node, string pathï¼Œmap<char, string>& huffman_code_table) {
  if (!node) return;
  if (!node->left && !node->right) {
    huffman_code_table[node->data] = path;
    return;
  }
  /** pass */
}
```

ç¬¬ä¸‰æ­¥ï¼Œå¦‚æœ`node`ä¸ä¸º`nullptr`ï¼Œä¸”`node->left`æˆ–è€…`node->right`ä¸ä¸º`nullptr`ï¼Œè¿™æ„å‘³ç€`node`ä¸æ˜¯å¶å­ç»“ç‚¹ï¼Œæ„å‘³ç€å®ƒä»¬æ˜¯è·¯å¾„ä¸Šçš„ç»“ç‚¹ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦å¾€å…¶å·¦å³ç»“ç‚¹ç»§ç»­å‘ä¸‹æœç´¢ï¼Œå¹¶ä¸”åœ¨æœç´¢çš„åŒæ—¶è®°å½•å½“å‰çš„è·¯å¾„ã€‚è¿›è¡Œé€’å½’æœç´¢ã€‚

```C++
void dfs(TreeNode* node, string pathï¼Œmap<char, string>& huffman_code_table) {
  if (!node) return;
  if (!node->left && !node->right) {
    huffman_code_table[node->data] = path;
    return;
  }
  dfs(node->left, path + "0");
  dfs(node->right, path + "1");
}
```

å¦‚æ­¤ï¼Œ`dfs`å°±ç®—å†™å®Œäº†ï¼Œå½“`dfs`æ¥å—åˆ°å“ˆå¤«æ›¼æ ‘çš„å¤´ç»“ç‚¹åï¼Œå®ƒå°±ä¼šä¸æ–­çš„æœç´¢ã€è®°å½•è·¯å¾„ï¼Œä¸€æ—¦é‡åˆ°å­—ç¬¦æ‰€åœ¨ç»“ç‚¹ï¼Œå°±å¼€å§‹å»ºç«‹å­—ç¬¦ä¸ç¼–ç çš„æ˜ å°„å…³ç³»ã€‚

ç”±äº`dfs`æ˜¯ä¸€ä¸ªé€’å½’å‡½æ•°ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªé¢å¤–çš„å‡½æ•°`generate_huffman_code`å¹¶ä¸”å€ŸåŠ©ä¹‹å‰å†™å¥½çš„`build`è°ƒç”¨å®ƒã€‚

```C++
map<char, string> generate_huffman_code(string& s) {
    map<char, string> huffman_code_table;
  	// æ ¹æ®sæ„å»ºå“ˆå¤«æ›¼æ ‘
    TreeNode* root = build(s);
    // å¯¹å“ˆå¤«æ›¼æ ‘è¿›è¡Œæ·±åº¦éå†æ„å»ºå“ˆå¤«æ›¼ç¼–ç 
    dfs(root, "", huffman_code_table);
  	// è¿”å›å“ˆå¤«æ›¼ç¼–ç æ˜ å°„è¡¨
    return huffman_code_table;
}
```

g++ -fPIC -Wl,-O1 -Wl,-z,relro -Wl,-rpath-link,/usr/lib64 -shared -Wl,-soname,libklayout_rba.so.0 -o libklayout_rba.so.0.28.0 rba.o rbaConvert.o rbaInspector.o rbaUtils.o rbaInternal.o rbaMarshal.o  -lz /public/home/zuochang/soft/ruby/lib/libruby-static.a -L/public/home/zuochang/work/luyukai/ted/klayout/build-release/rba/rba/../.. -lklayout_tl -lklayout_gsi -lQt5PrintSupport -lQt5Designer -lQt5MultimediaWidgets -lQt5Svg -lQt5Widgets -lQt5Multimedia -lQt5Gui -lQt5Xml -lQt5XmlPatterns -lQt5Network -lQt5Sql -lQt5Core -lGL -lpthread 

ä»¥ä¸Šæ“ä½œä¸€ç•ªåï¼Œæˆ‘ä»¬å°±å®Œæˆäº†å“ˆå¤«æ›¼æ ‘çš„æ„å»ºä¸å“ˆå¤«æ›¼ç¼–ç è¡¨çš„æ„å»ºã€‚ä¸€ä¸ªä¼Ÿå¤§çš„æ•°æ®å‹ç¼©ç®—æ³•å°±å¾—ä»¥å®ç°äº†ï¼

ç°åœ¨ä½ å¯ä»¥è¿è¡Œä»¥ä¸‹ç¤ºä¾‹ï¼Œçœ‹å…¶ç»“æœæ˜¯å¦ä¸ä»¥ä¸Šæ‰€è¯´çš„ä¸€è‡´ã€‚

### ç®€å•ç¤ºä¾‹

```C++
//
// Created by é‡æ¼«æ¨ªæ±Ÿ on 2022/5/17.
//
#include <iostream>
#include <map>
#include <vector>
#include <queue>
#include <utility>
using namespace std;
class TreeNode {
public:
    int weight;
    char data;
    TreeNode* left;
    TreeNode* right;
    TreeNode(int weight, char data) {
        this->weight = weight;
        this->data = data;
        this->left = nullptr;
        this->right = nullptr;
    }

    TreeNode(int weight, char data, TreeNode* left, TreeNode* right) {
        this->weight = weight;
        this->data = data;
        this->left = left;
        this->right = right;
    }

    ~TreeNode() {
        cout << "TreeNode -> weight: " <<  this->weight << " has been released." << endl;
    }

};
// ä¼˜å…ˆé˜Ÿåˆ—è‡ªå®šä¹‰æ’åºï¼Œæƒé‡é«˜çš„å‘åæ’
struct cmp {
    bool operator()(TreeNode* a, TreeNode* b) {
        return a->weight >= b->weight;
    }
};
/**
 * è¾“å‡ºå“ˆå¸Œè¡¨keyï¼Œvalåˆ°ç»ˆç«¯ï¼Œç”¨äºè°ƒè¯•
 * @tparam K
 * @tparam V
 * @param map
 */
template <typename K, typename V>
void log_map(map<K, V>& _map) {
    for (auto& packet : _map) {
        cout << "key: " << packet.first << ", val: " << packet.second << endl;
    }
}
/**
 * æ„å»ºå“ˆå¤«æ›¼æ ‘
 * @param s
 * @return
 */
TreeNode* build(string& s) {
    // æ„é€ ä¸€é¢—å“ˆå¤«æ›¼æ•°
    // é¦–å…ˆéœ€è¦ç»Ÿè®¡å­—ç¬¦ä¸²å‡ºç°çš„æ¬¡æ•°
    map<char, int> _map;
    for (char& c : s) _map[c]++;
    // ä½¿ç”¨ä¸€ä¸ªä¼˜å…ˆé˜Ÿåˆ—æ¥ç»´æŠ¤æƒå€¼çš„ä½ç½®å…³ç³»ï¼Œ
    priority_queue<TreeNode*, vector<TreeNode*>, cmp> que;
    for (auto& pack : _map) {
        int data = pack.first;
        char val = pack.second;
        que.push(new TreeNode(val, data));
    }
    // è‡ªåº•å‘ä¸Šæ„é€ å“ˆå¤«æ›¼æ ‘
    while (que.size() > 1) {
        TreeNode* node1 = que.top();
        que.pop();
        TreeNode* node2 = que.top();
        que.pop();
        int weight = node1->weight + node2->weight;
        // åˆå¹¶åçš„TreeNodeä½¿ç”¨ '\0' åŒºåˆ†
        que.push(new TreeNode(weight, '\0', node1, node2));
    }
    // è¿”å›å“ˆå¤«æ›¼æ ¹èŠ‚ç‚¹
    return que.top();
}

void dfs(TreeNode* node, string path, map<char, string>& huffman_code_table) {
    if (!node) return;
    if (!node->left && !node->right) {
        huffman_code_table[node->data] = path;
        return;
    }
    dfs(node->left, path + "0", huffman_code_table);
    dfs(node->right, path + "1", huffman_code_table);
}
/**
 * å¯¹å“ˆå¤«æ›¼æ ‘è¿›è¡Œæ·±åº¦éå†æ„å»ºå“ˆå¤«æ›¼ç¼–ç 
 * @param root å“ˆå¤«æ›¼æ ‘æ ¹èŠ‚ç‚¹
 * @return è¿”å›ç¼–ç è¡¨
 */
map<char, string> generate_huffman_code(string& s) {
    map<char, string> huffman_code_table;
    TreeNode* root = build(s);
    // å¯¹å“ˆå¤«æ›¼æ ‘è¿›è¡Œæ·±åº¦éå†æ„å»ºå“ˆå¤«æ›¼ç¼–ç 
    dfs(root, "", huffman_code_table);
    return huffman_code_table;
}

int main() {
    string s = "AAAAAABBCDDEEEEEF";
    map<char, string> table = generate_huffman_code(s);
    // è¾“å‡ºå“ˆå¤«æ›¼ç¼–ç ç»“æœ
    log_map(table);
    return 0;
}
```

### é¿å…æµªè´¹

è¿è¡Œå®Œç¤ºä¾‹åï¼Œä½ åº”è¯¥æ³¨æ„åˆ°äº†ä½¿ç”¨`new`ç”³è¯·åˆ°çš„å†…å­˜ä¼¼ä¹å¹¶æ²¡æœ‰è¢«é‡Šæ”¾æ‰ã€‚

æ˜¾ç„¶è¿™æ˜¯ä¸è´Ÿè´£ä»»çš„è¡Œä¸ºã€‚

æ‰€ä»¥ï¼Œåœ¨æˆ‘ä»¬ä½¿ç”¨`dfs`æ„å»ºå‡º`huffman_code_table`ä¹‹åï¼Œåº”è¯¥è¦æ‰‹åŠ¨å°†æˆ‘ä»¬äº²æ‰‹åˆ›å»ºå‡ºæ¥çš„æ•´é¢—å“ˆå¤«æ›¼æ ‘æ‰€å æ®çš„å†…å­˜é‡Šæ”¾æ‰ã€‚

å°†ä¸€æ•´é¢—å“ˆå¤«æ›¼æ ‘å†…å­˜é‡Šæ”¾ï¼Œä¹Ÿå°±æ˜¯éœ€è¦éå†ä¸€æ•´é¢—å“ˆå¤«æ›¼æ ‘ã€‚

æˆ‘éœ€è¦æ€æ ·éå†ï¼Ÿå†™ä»£ç çš„æ—¶å€™æˆ‘åœ¨è¿™ä¸ªé—®é¢˜ä¸Šæœ‰äº›ç–‘é—®ã€‚

å¦‚æœæˆ‘é‡‡ç”¨å…ˆåºéå†ã€‚

```C++
void release_tree_node_memory(TreeNode* root) {
    if (!root) return;
    delete root;
    release_tree_node_memory(root->left);
    release_tree_node_memory(root->right);
}
```



æ˜¾ç„¶ï¼Œé‡Šæ”¾æ‰`node`åï¼Œé‚£ä¹ˆ`node`æ•°æ®å·²ç»ä¸å­˜åœ¨ï¼Œæˆ‘å°±æ²¡æœ‰åŠæ³•è·å–åˆ°`node->left`ä¸`node->right`æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ç©ºé—´ï¼Œä¹Ÿå°±æ— æ³•é‡Šæ”¾`node->left`ä¸`node->right`å†…å­˜ç©ºé—´ä¸­çš„å†…å­˜äº†ã€‚

å¦‚æœæˆ‘é‡‡ç”¨ä¸­åºéå†ã€‚

```C++
void release_tree_node_memory(TreeNode* root) {
    if (!root) return;
    release_tree_node_memory(root->left);
    delete root;
    release_tree_node_memory(root->right);
}
```

ç²¾ç¡®é‡Šæ”¾äº†å“ˆå¤«æ›¼æ ‘æ‰€æœ‰å·¦å­æ•°å†…å­˜ï¼Œä¿ç•™å³å­æ•°ã€‚ï¼ˆä¿å·¦ä¸ä¿å³ï¼Œä»£ç å†™çš„éå¸¸å¥½ï¼Œä¸‹æ¬¡ä¸è¦å†å†™äº†ï¼‰

å¦‚æœæˆ‘é‡‡ç”¨ååºéå†ã€‚

```C++
void release_tree_node_memory(TreeNode* root) {
    if (!root) return;
    release_tree_node_memory(root->left);
    release_tree_node_memory(root->right);
    delete root;
}
```

èŠœæ¹–ï¼è‡ªåº•å‘ä¸Šé‡Šæ”¾äº†ä¸€æ•´é¢—äºŒå‰æ ‘ï¼å¤§å·¥å‘Šæˆï¼ŒâœŒï¸ï¼

```C++
//
// Created by é‡æ¼«æ¨ªæ±Ÿ on 2022/5/17.
//
#include <iostream>
#include <map>
#include <vector>
#include <queue>
#include <utility>
using namespace std;
class TreeNode {
public:
    int weight;
    char data;
    TreeNode* left;
    TreeNode* right;
    TreeNode(int weight, char data) {
        this->weight = weight;
        this->data = data;
        this->left = nullptr;
        this->right = nullptr;
    }

    TreeNode(int weight, char data, TreeNode* left, TreeNode* right) {
        this->weight = weight;
        this->data = data;
        this->left = left;
        this->right = right;
    }

    ~TreeNode() {
        cout << "TreeNode -> weight: " <<  this->weight << " has been released." << endl;
    }

};
// ä¼˜å…ˆé˜Ÿåˆ—è‡ªå®šä¹‰æ’åºï¼Œæƒé‡é«˜çš„å‘åæ’
struct cmp {
    bool operator()(TreeNode* a, TreeNode* b) {
        return a->weight >= b->weight;
    }
};
/**
 * è¾“å‡ºå“ˆå¸Œè¡¨keyï¼Œvalåˆ°ç»ˆç«¯ï¼Œç”¨äºè°ƒè¯•
 * @tparam K
 * @tparam V
 * @param map
 */
template <typename K, typename V>
void log_map(map<K, V>& _map) {
    for (auto& packet : _map) {
        cout << "key: " << packet.first << ", val: " << packet.second << endl;
    }
}
/**
 * è‡ªåº•å‘ä¸Šé‡Šæ”¾TreeNodeçš„å†…å­˜ç©ºé—´
 * @param root
 */
void release_tree_node_memory(TreeNode* root) {
    if (!root) return;
    release_tree_node_memory(root->left);
    release_tree_node_memory(root->right);
    delete root;
}
/**
 * æ„å»ºå“ˆå¤«æ›¼æ ‘
 * @param s
 * @return
 */
TreeNode* build(string& s) {
    // æ„é€ ä¸€é¢—å“ˆå¤«æ›¼æ•°
    // é¦–å…ˆéœ€è¦ç»Ÿè®¡å­—ç¬¦ä¸²å‡ºç°çš„æ¬¡æ•°
    map<char, int> _map;
    for (char& c : s) _map[c]++;
    // ä½¿ç”¨ä¸€ä¸ªä¼˜å…ˆé˜Ÿåˆ—æ¥ç»´æŠ¤æƒå€¼çš„ä½ç½®å…³ç³»ï¼Œ
    priority_queue<TreeNode*, vector<TreeNode*>, cmp> que;
    for (auto& pack : _map) {
        int data = pack.first;
        char val = pack.second;
        que.push(new TreeNode(val, data));
    }
    // è‡ªåº•å‘ä¸Šæ„é€ å“ˆå¤«æ›¼æ ‘
    while (que.size() > 1) {
        TreeNode* node1 = que.top();
        que.pop();
        TreeNode* node2 = que.top();
        que.pop();
        int weight = node1->weight + node2->weight;
        // åˆå¹¶åçš„TreeNodeä½¿ç”¨ '\0' åŒºåˆ†
        que.push(new TreeNode(weight, '\0', node1, node2));
    }
    // è¿”å›å“ˆå¤«æ›¼æ ¹èŠ‚ç‚¹
    return que.top();
}

void dfs(TreeNode* node, string path, map<char, string>& huffman_code_table) {
    if (!node) return;
    if (!node->left && !node->right) {
        huffman_code_table[node->data] = path;
        return;
    }
    dfs(node->left, path + "0", huffman_code_table);
    dfs(node->right, path + "1", huffman_code_table);
}
/**
 * å¯¹å“ˆå¤«æ›¼æ ‘è¿›è¡Œæ·±åº¦éå†æ„å»ºå“ˆå¤«æ›¼ç¼–ç 
 * @param root å“ˆå¤«æ›¼æ ‘æ ¹èŠ‚ç‚¹
 * @return è¿”å›ç¼–ç è¡¨
 */
map<char, string> generate_huffman_code(string& s) {
    map<char, string> huffman_code_table;
    TreeNode* root = build(s);
    // å¯¹å“ˆå¤«æ›¼æ ‘è¿›è¡Œæ·±åº¦éå†æ„å»ºå“ˆå¤«æ›¼ç¼–ç 
    dfs(root, "", huffman_code_table);
    release_tree_node_memory(root); // å°†rootæ‰€å¼•ç”¨çš„æ‰€ç”¨æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ç©ºé—´å…¨éƒ¨é‡Šæ”¾
    return huffman_code_table;
}

int main() {
    string s = "AAAAAABBCDDEEEEEF";
    map<char, string> table = generate_huffman_code(s);
    // è¾“å‡ºå“ˆå¤«æ›¼ç¼–ç ç»“æœ
    log_map(table);
    return 0;
}
```

### è¿è¡Œç»“æœ

```
TreeNode -> weight: 6 has been released.
TreeNode -> weight: 5 has been released.
TreeNode -> weight: 2 has been released.
TreeNode -> weight: 1 has been released.
TreeNode -> weight: 1 has been released.
TreeNode -> weight: 2 has been released.
TreeNode -> weight: 2 has been released.
TreeNode -> weight: 4 has been released.
TreeNode -> weight: 6 has been released.
TreeNode -> weight: 11 has been released.
TreeNode -> weight: 17 has been released.
key: A, val: 0
key: B, val: 110
key: C, val: 11101
key: D, val: 1111
key: E, val: 10
key: F, val: 11100

```

### ç¢ç¢è¯

è¿™ç¯‡æ–‡ç« ç”¨äº†ä¸¤å¤©æ—¶é—´å®Œæˆã€‚

ä»Šå¤©åœ¨è¶…ç®—ä¸Šè£…klayoutï¼Œç”±äºæ²¡æœ‰rootæƒé™ï¼Œæ‰€ä»¥åªå¥½clone æºç è¿›è¡Œç¼–è¯‘å®‰è£…ï¼Œæ²¡æƒ³åˆ°å±…ç„¶èƒ½ç¼–è¯‘4ä¸ªå°æ—¶ï¼Œä¸€ä¸‹åˆå¤©éƒ½é»‘äº†ï¼Œæ¼«é•¿çš„ç­‰å¾…ï¼Œäºæ˜¯ä¸€è¾¹å†™æ–‡ç« ï¼Œä¸€è¾¹çœ‹ç¼–è¯‘æ˜¯å¦å®Œæˆã€‚

æ²¡æƒ³åˆ°æ–‡ç« è¿˜æ²¡å†™å®Œï¼Œæœ€æ‹…å¿ƒçš„äº‹æƒ…è¿˜æ˜¯å‘ç”Ÿäº†ï¼Œå®ƒå±…ç„¶æŠ¥é”™äº†...å¿ƒä¸­äº”å‘³æ‚é™ˆï¼Œæˆå¹´äººçš„å´©æºƒå°±åœ¨ä¸€ç¬é—´ï¼Œä¸€æ—¶é—´éš¾ä»¥æ¥å—è¿™æ ·çš„äº‹å®ã€‚åªå¥½å…ˆæŠŠè¿™ç¯‡å†™å®Œï¼Œå†å»å°è¯•é—®é¢˜å¦‚ä½•è§£å†³ã€‚ç—›ï¼Œå®åœ¨å¤ªç—›äº†ï¼

å†™åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œä½†è¿˜æƒ³å†ç½—å—¦ä¸€å¥ã€‚

> `cmake`ï¼ŒğŸ¶éƒ½ä¸ç”¨ï¼
>
> *â€”â€”class-undefined*

*2022å¹´5æœˆ18æ—¥ äºå¯å®¤ è¢«ç¯å¢ƒé…ç½®æŠ˜ç£¨ å¥„å¥„ç„¶*



